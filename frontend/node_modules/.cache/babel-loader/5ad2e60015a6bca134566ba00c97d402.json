{"ast":null,"code":"var _jsxFileName = \"/home/dd/Desktop/nangua/frontend/src/content/container/user/signup.js\";\nimport React from 'react';\nimport { Form, Input, Button } from 'antd';\nimport { theUrl } from 'selfConfig';\n\nvar Signup = function Signup(props) {\n  var comfirmDirty = false;\n  var getFieldDecorator = props.form.getFieldDecorator;\n\n  var handleSubmit = function handleSubmit(e) {\n    e.preventDefault();\n    props.form.validateFields(function (err, values) {\n      if (!err) {\n        var url = theUrl + '/signup';\n        fetch(url, {\n          headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n          },\n          method: 'POST',\n          body: JSON.stringify({\n            username: values.email,\n            password: values.password\n          })\n        }).then(function (res) {\n          return res.json();\n        }).then(function (res) {\n          if (res.signup) {\n            props.history.push(\"/user_login\");\n          } else {\n            props.history.push(\"/signup\");\n          }\n        });\n      }\n    });\n  };\n\n  var validateEmail = function validateEmail(email) {\n    if (/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/.test(email)) {\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var checkemail = function checkemail(rule, value, callback) {\n    // check email format\n    if (!validateEmail(value)) {\n      callback(\"This is not a valid email\");\n    } // check db if username repeats \n\n\n    var url = theUrl + '/duplicationCheck';\n    fetch(url, {\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      },\n      method: 'POST',\n      body: JSON.stringify({\n        username: value\n      })\n    }).then(function (res) {\n      return res.json();\n    }).then(function (res) {\n      console.log(res.existence);\n\n      if (res.existence) {\n        callback('useranem existence');\n      } else {\n        callback();\n      }\n    });\n  };\n\n  var validateToNextPassword = function validateToNextPassword(rule, value, callback) {\n    var form = props.form;\n\n    if (value && comfirmDirty) {\n      form.validataFields(['confirm'], {\n        force: true\n      });\n    }\n\n    callback();\n  };\n\n  var compareToFirstPassword = function compareToFirstPassword(rules, value, callback) {\n    var form = props.form;\n\n    if (value && value !== form.getFieldValue('password')) {\n      callback('Two password that you entry are inconsistent');\n    } else {\n      callback();\n    }\n  };\n\n  return React.createElement(Form, {\n    onSubmit: handleSubmit,\n    style: {\n      width: \"20rem\",\n      margin: \"0 auto\",\n      marginTop: \"2rem\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, React.createElement(Form.Item, {\n    label: \"Email\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, getFieldDecorator('email', {\n    rules: [{\n      required: true,\n      message: 'Please input your username'\n    }, {\n      validator: checkemail\n    }],\n    validateTrigger: 'onBlur'\n  })(React.createElement(Input, {\n    placeholder: \"email\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }))), React.createElement(Form.Item, {\n    label: \"Password\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, getFieldDecorator('password', {\n    rules: [{\n      required: true,\n      message: 'Please input your message'\n    }, {\n      validator: validateToNextPassword\n    }]\n  })(React.createElement(Input, {\n    type: \"password\",\n    placeholder: \"password\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }))), React.createElement(Form.Item, {\n    label: \"Input password again\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }, getFieldDecorator('confirm', {\n    rules: [{\n      required: true,\n      message: 'Please input your password again'\n    }, {\n      validator: compareToFirstPassword\n    }]\n  })(React.createElement(Input, {\n    type: \"password\",\n    placeholder: \"input password again\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }))), React.createElement(Form.Item, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, React.createElement(Button, {\n    tpye: \"primary\",\n    htmlType: \"submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, \"sign up\")));\n};\n\nexport default Form.create({\n  name: 'normal_login'\n})(Signup);","map":{"version":3,"sources":["/home/dd/Desktop/nangua/frontend/src/content/container/user/signup.js"],"names":["React","Form","Input","Button","theUrl","Signup","props","comfirmDirty","getFieldDecorator","form","handleSubmit","e","preventDefault","validateFields","err","values","url","fetch","headers","method","body","JSON","stringify","username","email","password","then","res","json","signup","history","push","validateEmail","test","checkemail","rule","value","callback","console","log","existence","validateToNextPassword","validataFields","force","compareToFirstPassword","rules","getFieldValue","width","margin","marginTop","required","message","validator","validateTrigger","create","name"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SACIC,IADJ,EACUC,KADV,EACiBC,MADjB,QAEO,MAFP;AAGA,SAASC,MAAT,QAAuB,YAAvB;;AAGA,IAAMC,MAAM,GAAG,SAATA,MAAS,CAACC,KAAD,EAAW;AAEtB,MAAIC,YAAY,GAAG,KAAnB;AAFsB,MAIdC,iBAJc,GAIQF,KAAK,CAACG,IAJd,CAIdD,iBAJc;;AAMtB,MAAME,YAAY,GAAG,SAAfA,YAAe,CAACC,CAAD,EAAO;AACxBA,IAAAA,CAAC,CAACC,cAAF;AAEAN,IAAAA,KAAK,CAACG,IAAN,CAAWI,cAAX,CAA0B,UAACC,GAAD,EAAMC,MAAN,EAAe;AACrC,UAAI,CAACD,GAAL,EAAW;AACP,YAAME,GAAG,GAAGZ,MAAM,GAAG,SAArB;AACAa,QAAAA,KAAK,CAACD,GAAD,EAAM;AACPE,UAAAA,OAAO,EAAE;AACL,sBAAS,kBADJ;AAEL,4BAAgB;AAFX,WADF;AAKPC,UAAAA,MAAM,EAAE,MALD;AAMPC,UAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACjBC,YAAAA,QAAQ,EAAER,MAAM,CAACS,KADA;AAEjBC,YAAAA,QAAQ,EAAEV,MAAM,CAACU;AAFA,WAAf;AANC,SAAN,CAAL,CAWCC,IAXD,CAWO,UAAAC,GAAG,EAAI;AAAE,iBAAOA,GAAG,CAACC,IAAJ,EAAP;AAAmB,SAXnC,EAYCF,IAZD,CAYO,UAAAC,GAAG,EAAI;AACV,cAAKA,GAAG,CAACE,MAAT,EAAkB;AACdvB,YAAAA,KAAK,CAACwB,OAAN,CAAcC,IAAd,CAAmB,aAAnB;AACH,WAFD,MAEO;AACHzB,YAAAA,KAAK,CAACwB,OAAN,CAAcC,IAAd,CAAmB,SAAnB;AACH;AACJ,SAlBD;AAmBH;AACJ,KAvBD;AAwBH,GA3BD;;AA6BA,MAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACR,KAAD,EAAW;AAC7B,QAAI,gDAAgDS,IAAhD,CAAqDT,KAArD,CAAJ,EAAiE;AAC7D,aAAO,IAAP;AACH,KAFD,MAEO;AACH,aAAO,KAAP;AACH;AACJ,GAND;;AAQA,MAAMU,UAAU,GAAG,SAAbA,UAAa,CAACC,IAAD,EAAOC,KAAP,EAAcC,QAAd,EAA2B;AAC1C;AACA,QAAI,CAACL,aAAa,CAACI,KAAD,CAAlB,EAA4B;AACxBC,MAAAA,QAAQ,CAAC,2BAAD,CAAR;AACH,KAJyC,CAM1C;;;AACA,QAAMrB,GAAG,GAAEZ,MAAM,GAAC,mBAAlB;AACAa,IAAAA,KAAK,CAACD,GAAD,EAAM;AACPE,MAAAA,OAAO,EAAE;AACL,kBAAS,kBADJ;AAEL,wBAAgB;AAFX,OADF;AAKPC,MAAAA,MAAM,EAAE,MALD;AAMPC,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACjBC,QAAAA,QAAQ,EAAEa;AADO,OAAf;AANC,KAAN,CAAL,CAUCV,IAVD,CAUM,UAAAC,GAAG,EAAI;AAAE,aAAOA,GAAG,CAACC,IAAJ,EAAP;AAAmB,KAVlC,EAWCF,IAXD,CAWM,UAAAC,GAAG,EAAI;AACTW,MAAAA,OAAO,CAACC,GAAR,CAAYZ,GAAG,CAACa,SAAhB;;AACA,UAAIb,GAAG,CAACa,SAAR,EAAmB;AACfH,QAAAA,QAAQ,CAAC,oBAAD,CAAR;AACH,OAFD,MAEO;AACHA,QAAAA,QAAQ;AACX;AACJ,KAlBD;AAmBH,GA3BD;;AA6BA,MAAMI,sBAAsB,GAAG,SAAzBA,sBAAyB,CAACN,IAAD,EAAOC,KAAP,EAAcC,QAAd,EAA2B;AACtD,QAAM5B,IAAI,GAAGH,KAAK,CAACG,IAAnB;;AACA,QAAK2B,KAAK,IAAI7B,YAAd,EAA4B;AACxBE,MAAAA,IAAI,CAACiC,cAAL,CAAoB,CAAC,SAAD,CAApB,EAAiC;AAAEC,QAAAA,KAAK,EAAE;AAAT,OAAjC;AACH;;AACDN,IAAAA,QAAQ;AACX,GAND;;AAQA,MAAMO,sBAAsB,GAAG,SAAzBA,sBAAyB,CAACC,KAAD,EAAQT,KAAR,EAAeC,QAAf,EAA4B;AACvD,QAAM5B,IAAI,GAAGH,KAAK,CAACG,IAAnB;;AACA,QAAI2B,KAAK,IAAIA,KAAK,KAAK3B,IAAI,CAACqC,aAAL,CAAmB,UAAnB,CAAvB,EAAuD;AACnDT,MAAAA,QAAQ,CAAC,8CAAD,CAAR;AACH,KAFD,MAEO;AACHA,MAAAA,QAAQ;AACX;AACJ,GAPD;;AAQA,SACI,oBAAC,IAAD;AAAM,IAAA,QAAQ,EAAE3B,YAAhB;AACI,IAAA,KAAK,EAAE;AAAEqC,MAAAA,KAAK,EAAE,OAAT;AAAkBC,MAAAA,MAAM,EAAE,QAA1B;AAAoCC,MAAAA,SAAS,EAAE;AAA/C,KADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAGI,oBAAC,IAAD,CAAM,IAAN;AAAW,IAAA,KAAK,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACCzC,iBAAiB,CAAC,OAAD,EAAU;AACxBqC,IAAAA,KAAK,EAAE,CAAC;AACJK,MAAAA,QAAQ,EAAE,IADN;AACYC,MAAAA,OAAO,EAAE;AADrB,KAAD,EAEJ;AACCC,MAAAA,SAAS,EAAElB;AADZ,KAFI,CADiB;AAMxBmB,IAAAA,eAAe,EAAE;AANO,GAAV,CAAjB,CAQA,oBAAC,KAAD;AAAO,IAAA,WAAW,EAAC,OAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IARA,CADD,CAHJ,EAeI,oBAAC,IAAD,CAAM,IAAN;AAAW,IAAA,KAAK,EAAC,UAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACC7C,iBAAiB,CAAC,UAAD,EAAa;AAC3BqC,IAAAA,KAAK,EAAE,CAAC;AACJK,MAAAA,QAAQ,EAAG,IADP;AACaC,MAAAA,OAAO,EAAE;AADtB,KAAD,EAEJ;AACCC,MAAAA,SAAS,EAAEX;AADZ,KAFI;AADoB,GAAb,CAAjB,CAME,oBAAC,KAAD;AAAO,IAAA,IAAI,EAAC,UAAZ;AAAuB,IAAA,WAAW,EAAC,UAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANF,CADD,CAfJ,EAyBI,oBAAC,IAAD,CAAM,IAAN;AAAW,IAAA,KAAK,EAAC,sBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACCjC,iBAAiB,CAAC,SAAD,EAAW;AACzBqC,IAAAA,KAAK,EAAE,CAAC;AACJK,MAAAA,QAAQ,EAAE,IADN;AACYC,MAAAA,OAAO,EAAE;AADrB,KAAD,EAEJ;AACCC,MAAAA,SAAS,EAAER;AADZ,KAFI;AADkB,GAAX,CAAjB,CAME,oBAAC,KAAD;AAAO,IAAA,IAAI,EAAC,UAAZ;AAAuB,IAAA,WAAW,EAAC,sBAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANF,CADD,CAzBJ,EAmCI,oBAAC,IAAD,CAAM,IAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACA,oBAAC,MAAD;AAAQ,IAAA,IAAI,EAAC,SAAb;AAAuB,IAAA,QAAQ,EAAC,QAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADA,CAnCJ,CADJ;AAyCH,CAjID;;AAoIA,eAAe3C,IAAI,CAACqD,MAAL,CAAY;AAACC,EAAAA,IAAI,EAAE;AAAP,CAAZ,EAAoClD,MAApC,CAAf","sourcesContent":["import React from 'react'\nimport {\n    Form, Input, Button\n} from 'antd';\nimport { theUrl } from 'selfConfig'\n\n\nconst Signup = (props) => {\n\n    let comfirmDirty = false\n\n    const { getFieldDecorator } = props.form\n    \n    const handleSubmit = (e) => {\n        e.preventDefault()\n\n        props.form.validateFields((err, values)=>{\n            if( !err ) {\n                const url = theUrl + '/signup'\n                fetch(url, {\n                    headers: {\n                        'Accept':'application/json',\n                        'Content-Type': 'application/json'\n                    },\n                    method: 'POST',\n                    body: JSON.stringify({\n                        username: values.email,\n                        password: values.password\n                    })\n                })\n                .then( res => { return res.json() })\n                .then( res => {\n                    if ( res.signup ) {\n                        props.history.push(\"/user_login\")\n                    } else {\n                        props.history.push(\"/signup\")\n                    }\n                })\n            }\n        })\n    }\n\n    const validateEmail = (email) => {\n        if (/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/.test(email)) {\n            return true\n        } else {\n            return false\n        }\n    }\n\n    const checkemail = (rule, value, callback) => {\n        // check email format\n        if( !validateEmail(value) ) {\n            callback(\"This is not a valid email\")\n        }\n\n        // check db if username repeats \n        const url= theUrl+'/duplicationCheck'\n        fetch(url, {\n            headers: {\n                'Accept':'application/json',\n                'Content-Type': 'application/json'\n            },\n            method: 'POST',\n            body: JSON.stringify({\n                username: value,\n            })\n        })\n        .then(res => { return res.json() })\n        .then(res => {\n            console.log(res.existence)\n            if (res.existence) {\n                callback('useranem existence')\n            } else {\n                callback()\n            }\n        })\n    }\n\n    const validateToNextPassword = (rule, value, callback) => {\n        const form = props.form\n        if ( value && comfirmDirty) {\n            form.validataFields(['confirm'], { force: true })\n        }\n        callback()\n    }\n\n    const compareToFirstPassword = (rules, value, callback) => {\n        const form = props.form\n        if( value && value !== form.getFieldValue('password')) {\n            callback('Two password that you entry are inconsistent')\n        } else {\n            callback()\n        }\n    }\n    return(\n        <Form onSubmit={handleSubmit}\n            style={{ width: \"20rem\", margin: \"0 auto\", marginTop: \"2rem\" }}\n        >\n            <Form.Item label=\"Email\">\n            {getFieldDecorator('email', {\n                rules: [{\n                    required: true, message: 'Please input your username'\n                }, {\n                    validator: checkemail\n                }],\n                validateTrigger: 'onBlur'\n            })\n            (<Input placeholder=\"email\"/>)}\n            </Form.Item>\n\n            <Form.Item label=\"Password\">\n            {getFieldDecorator('password', {\n                rules: [{\n                    required : true, message: 'Please input your message'\n                }, {\n                    validator: validateToNextPassword\n                }]\n            })(<Input type=\"password\" placeholder=\"password\"/>)}\n            </Form.Item>\n\n            <Form.Item label=\"Input password again\">\n            {getFieldDecorator('confirm',{\n                rules: [{\n                    required: true, message: 'Please input your password again'\n                }, {\n                    validator: compareToFirstPassword\n                }]\n            })(<Input type=\"password\" placeholder=\"input password again\"/>)}\n            </Form.Item>\n\n            <Form.Item>\n            <Button tpye=\"primary\" htmlType=\"submit\">sign up</Button>\n            </Form.Item>\n        </Form>\n    )\n}\n\n\nexport default Form.create({name: 'normal_login'})(Signup)"]},"metadata":{},"sourceType":"module"}